<div class="row">
  <div class="col">
    <app-logbook-operation-facet
      [facetDetails]="facetDetails"
    ></app-logbook-operation-facet>
  </div>
</div>
<div class="row">
  <div class="col mt-4 mb-2">
    <h5>{{ 'COLLECT.PROJECT_LIST_TITLE' | translate }}</h5>
  </div>
</div>
<div class="row">
  <div class="col">
  <div vitamuiCommonInfiniteScroll (vitamuiScroll)="onScroll()">
    <div class="vitamui-table">
      <div class="vitamui-table-head title-text result-layout">
        <div class="col-11">
          {{ 'COLLECT.NB_ENTRIES' | translate: { nb: dataSource?.length } }}
        </div>
      </div>
      <div class="vitamui-table-head">
        <div class="col-1"></div>
        <div class="col-3">
          <span>{{ 'COLLECT.FIELD_MESSAGE_IDENTIFIER' | translate }}</span>
          <vitamui-common-order-by-button
            orderByKey="messageIdentifier"
            [(orderBy)]="orderBy"
            [(direction)]="direction"
            (orderChange)="emitOrderChange($event)"
          ></vitamui-common-order-by-button>
        </div>
        <div class="col-2">
          <span>{{ 'COLLECT.FIELD_SUBMISSION_AGENCY_IDENTIFIER' | translate }}</span>
          <vitamui-common-order-by-button
            orderByKey="submissionAgencyIdentifier"
            [(orderBy)]="orderBy"
            [(direction)]="direction"
            (orderChange)="emitOrderChange($event)"
          ></vitamui-common-order-by-button>
        </div>
        <div class="col-2">
          <span>{{ 'COLLECT.FIELD_CREATED_ON' | translate }}</span>
          <vitamui-common-order-by-button
            orderByKey="createdOn"
            [(orderBy)]="orderBy"
            [(direction)]="direction"
            (orderChange)="emitOrderChange($event)"
          ></vitamui-common-order-by-button>
        </div>
        <div class="col-2">
          <span>{{ 'COLLECT.FIELD_LAST_MODIFY_ON' | translate }}</span>
          <vitamui-common-order-by-button
            orderByKey="lastModifyOn"
            [(orderBy)]="orderBy"
            [(direction)]="direction"
            (orderChange)="emitOrderChange($event)"
          ></vitamui-common-order-by-button>
        </div>
        <div class="col-2">
          <span>{{ 'COLLECT.FIELD_STATUS' | translate }}</span>
          <vitamui-common-order-by-button
            orderByKey="status"
            [(orderBy)]="orderBy"
            [(direction)]="direction"
            (orderChange)="emitOrderChange($event)"
          ></vitamui-common-order-by-button>
        </div>
      </div>

      <div class="vitamui-table-body">
        <div
          class="vitamui-table-rows"
          *ngFor="let project of dataSource"
        >
          <div class="vitamui-row d-flex align-items-center clickable">
            <div class="col-1">
              <i class="vitamui-icon vitamui-icon-flux-manuel-refus">
                <span class="path1"></span>
                <span class="path2"></span>
                <span class="path3"></span>
                <span class="path4"></span>
              </i>
            </div>
            <div class="col-3">{{ project.messageIdentifier }}</div>
            <div class="col-2">{{ project.submissionAgencyIdentifier}}</div>
            <div class="col-2">{{ project.createdOn | date:'dd/MM/yyyy' | empty }}</div>
            <div class="col-2">{{ project.lastModifyOn | date:'dd/MM/yyyy' | empty }}</div>
            <div class="col-2">{{ project.status }}</div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="!dataSource || pending; then loadingSpinner"></div>
    <div *ngIf="!pending && dataSource?.length === 0; then noResults"></div>
    <div *ngIf="infiniteScrollDisabled && projectsService.canLoadMore && !pending; then loadMore"></div>
  </div>

  <ng-template #noResults>
    <div class="vitamui-min-content vitamui-table-message">{{ 'COLLECT.NO_RESULT' | translate }}</div>
  </ng-template>

  <ng-template #loadMore>
    <div class="vitamui-min-content vitamui-table-message" (click)="projectsService.loadMore()">
      <span class="clickable">{{ 'COLLECT.LOAD_MORE_RESULTS' | translate }}</span>
    </div>
  </ng-template>

  <ng-template #loadingSpinner>
    <div class="vitamui-min-content">
      <mat-spinner class="vitamui-spinner medium"></mat-spinner>
    </div>
  </ng-template>
  </div>
</div>
